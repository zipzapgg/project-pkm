{% extends "base.html" %}
{% block title %}Hasil Rekomendasi Jurusan{% endblock %}
{% block content %}

<div class="card shadow-lg mx-auto p-5 fade-in-scale" style="max-width: 900px;">
  <!-- Header dengan Icon -->
  <div class="text-center mb-4">
    <div class="mb-3">
      <span style="font-size: 4rem; display: inline-block; animation: celebrate 1s ease;">ğŸ‰</span>
    </div>
    <h3 class="fw-bold mb-2" style="color: #2d3748;">Hasil Rekomendasi Jurusan Kuliah</h3>
    <p class="text-muted">Berdasarkan analisis Fuzzy Logic dari data yang kamu input</p>
  </div>

  <!-- Info Siswa -->
  <div class="text-center mb-4 p-4" style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.08), rgba(118, 75, 162, 0.08)); border-radius: 20px;">
    <p class="mb-2 fs-5">
      <strong>Nama:</strong> <span class="text-primary fw-bold">{{ nama }}</span>
    </p>
  </div>

  <!-- Skor Kesesuaian dengan Visual Meter -->
  <div class="text-center my-4 p-4 position-relative" style="background: linear-gradient(135deg, rgba(17, 153, 142, 0.05), rgba(56, 239, 125, 0.05)); border-radius: 20px; overflow: hidden;">
    <div style="position: absolute; top: 0; left: 0; height: 100%; width: {{ skor }}%; background: linear-gradient(90deg, rgba(17, 153, 142, 0.2), rgba(56, 239, 125, 0.2)); transition: width 1s ease; border-radius: 20px;"></div>
    
    <div style="position: relative; z-index: 2;">
      <h6 class="fw-bold text-secondary mb-3">ğŸ“Š Skor Kesesuaian Fuzzy Umum</h6>
      <h1 class="display-3 fw-bold mb-3" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
        {{ "%.1f"|format(skor) }}
      </h1>
      <div class="mb-2">
        {% if skor >= 75 %}
          <span class="badge bg-success px-4 py-2" style="font-size: 1rem;">âœ… Sangat Cocok</span>
        {% elif skor >= 60 %}
          <span class="badge bg-info px-4 py-2" style="font-size: 1rem;">ğŸ‘ Cocok</span>
        {% elif skor >= 45 %}
          <span class="badge bg-warning text-dark px-4 py-2" style="font-size: 1rem;">âš ï¸ Cukup Sesuai</span>
        {% else %}
          <span class="badge bg-secondary px-4 py-2" style="font-size: 1rem;">â„¹ï¸ Perlu Pertimbangan</span>
        {% endif %}
      </div>
      <small class="text-muted">
        {% if skor >= 65 %}
          Profil kamu sangat cocok dengan jurusan-jurusan berikut!
        {% elif skor >= 45 %}
          Profil kamu cukup sesuai, pertimbangkan dengan matang ya!
        {% else %}
          Yuk eksplorasi minat & kemampuanmu lebih lanjut!
        {% endif %}
      </small>
    </div>
  </div>

  <hr class="my-5">

  <!-- Chart Radar Minat -->
  <div class="mb-5">
    <h5 class="fw-bold text-center mb-4" style="color: #2d3748;">
      ğŸ“ˆ Visualisasi Profil Minat Kamu
    </h5>
    <p class="text-center text-muted mb-4 small">
      Diagram ini menunjukkan kekuatan minatmu di empat area kunci untuk menentukan jurusan
    </p>
    <div class="chart-container" style="position: relative; height:380px; width:100%; max-width:550px; margin: auto;">
        <canvas id="minatChart"></canvas>
    </div>
  </div>

  <hr class="my-5">

  <!-- Top 3 Rekomendasi -->
  <div class="mb-4">
    <h5 class="fw-bold mb-4" style="color: #2d3748;">
      ğŸ† Top 3 Rekomendasi Jurusan Untukmu
    </h5>

    <div class="row g-3">
      {% for jurusan, nilai in hasil %}
      <div class="col-12">
        <div class="card border-0 h-100 position-relative" style="background: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(248,249,250,0.9)); overflow: hidden;">
          <!-- Rank Badge -->
          <div class="position-absolute top-0 start-0 m-3">
            <span class="badge" style="background: linear-gradient(135deg, {% if loop.index == 1 %}#FFD700{% elif loop.index == 2 %}#C0C0C0{% else %}#CD7F32{% endif %}, {% if loop.index == 1 %}#FFA500{% elif loop.index == 2 %}#A0A0A0{% else %}#8B4513{% endif %}); font-size: 1.2rem; padding: 8px 16px; border-radius: 12px;">
              #{{ loop.index }}
            </span>
          </div>
          
          <div class="card-body pt-5 pb-4 px-4">
            <div class="d-flex justify-content-between align-items-start mb-3">
              <div style="flex: 1;">
                <h5 class="fw-bold mb-2" style="color: #2d3748;">{{ jurusan }}</h5>
                <p class="text-muted mb-3 small">
                  {% if "Informatika" in jurusan %}
                    ğŸ”¹ Cocok untuk siswa dengan kemampuan logika, matematika, dan problem solving tinggi.<br>
                    <strong>Prospek:</strong> Software Engineer, Data Scientist, AI Specialist
                  {% elif "Sistem Informasi" in jurusan %}
                    ğŸ”¹ Kombinasi antara teknologi dan bisnis. Cocok yang suka analisis tapi juga berinteraksi dengan orang.<br>
                    <strong>Prospek:</strong> Business Analyst, IT Consultant, System Analyst
                  {% elif "Manajemen" in jurusan %}
                    ğŸ”¹ Cocok bagi yang punya minat sosial dan kemampuan analisis bisnis.<br>
                    <strong>Prospek:</strong> Manager, Entrepreneur, HR Specialist
                  {% elif "Komunikasi" in jurusan %}
                    ğŸ”¹ Sesuai bagi yang ekspresif, komunikatif, dan suka storytelling.<br>
                    <strong>Prospek:</strong> Public Relations, Content Creator, Journalist
                  {% elif "Psikologi" in jurusan %}
                    ğŸ”¹ Tepat bagi yang suka memahami perilaku manusia dan empati tinggi.<br>
                    <strong>Prospek:</strong> Psikolog Klinis, HR, Counselor
                  {% elif "Desain" in jurusan %}
                    ğŸ”¹ Ideal untuk siswa kreatif dengan imajinasi visual dan estetika tinggi.<br>
                    <strong>Prospek:</strong> Graphic Designer, UI/UX Designer, Animator
                  {% elif "Sastra Inggris" in jurusan %}
                    ğŸ”¹ Cocok bagi yang menguasai bahasa asing, suka membaca dan menulis.<br>
                    <strong>Prospek:</strong> Translator, Editor, English Teacher
                  {% elif "Sastra Indonesia" in jurusan %}
                    ğŸ”¹ Sesuai bagi yang mencintai bahasa, sastra, dan dunia kepenulisan.<br>
                    <strong>Prospek:</strong> Penulis, Editor, Jurnalis
                  {% elif "Arsitektur" in jurusan %}
                    ğŸ”¹ Perpaduan kreativitas dan logika teknis. Cocok yang suka desain dan matematika.<br>
                    <strong>Prospek:</strong> Arsitek, Urban Planner, Interior Designer
                  {% elif "PGSD" in jurusan %}
                    ğŸ”¹ Rekomendasi bagi yang sabar, komunikatif, dan suka mengajar anak-anak.<br>
                    <strong>Prospek:</strong> Guru SD, Pendidik PAUD
                  {% else %}
                    ğŸ”¹ Jurusan yang sesuai dengan profil akademik dan minat kamu.
                  {% endif %}
                </p>
                
                <div class="mt-3">
                  {% if nilai >= 75 %}
                    <span class="badge bg-success px-3 py-2">â­ Sangat Cocok</span>
                  {% elif nilai >= 60 %}
                    <span class="badge bg-info px-3 py-2">ğŸ‘ Cocok</span>
                  {% elif nilai >= 45 %}
                    <span class="badge bg-warning text-dark px-3 py-2">âš ï¸ Cukup Cocok</span>
                  {% else %}
                    <span class="badge bg-secondary px-3 py-2">ğŸ’­ Pertimbangkan</span>
                  {% endif %}
                </div>
              </div>
              
              <div class="ms-4 text-center">
                <div style="width: 90px; height: 90px; border-radius: 50%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem; font-weight: 800; box-shadow: 0 8px 24px rgba(102, 126, 234, 0.3);">
                  {{ "%.1f"|format(nilai) }}
                </div>
                <small class="text-muted d-block mt-2">Skor Match</small>
              </div>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>

  <!-- Info Box -->
  <div class="alert alert-info border-0 mt-5 p-4" role="alert" style="border-radius: 20px; background: linear-gradient(135deg, rgba(79, 172, 254, 0.1), rgba(0, 242, 254, 0.1));">
    <h6 class="fw-bold mb-2">ğŸ’¡ Catatan Penting</h6>
    <p class="mb-0 small">
      Rekomendasi ini berdasarkan analisis <strong>Fuzzy Logic</strong> dari nilai akademik dan minat kamu. 
      Pertimbangkan juga faktor lain seperti <strong>passion</strong>, <strong>peluang karir</strong>, dan <strong>kondisi finansial</strong> sebelum memutuskan. 
      Konsultasikan dengan orangtua, guru BK, atau kakak tingkat untuk mendapat perspektif lebih lengkap!
    </p>
  </div>

  <!-- Action Buttons -->
  <div class="text-center mt-5 d-flex gap-3 justify-content-center flex-wrap">
    <a href="/tes" class="btn btn-outline-primary px-4 py-3">
      ğŸ”„ Ulangi Tes
    </a>
    <button onclick="window.print()" class="btn btn-outline-secondary px-4 py-3">
      ğŸ–¨ï¸ Cetak/Simpan Hasil
    </button>
    <a href="/" class="btn btn-primary px-4 py-3">
      ğŸ  Kembali ke Beranda
    </a>
  </div>
</div>

<style>
  @keyframes celebrate {
    0%, 100% { transform: scale(1) rotate(0deg); }
    25% { transform: scale(1.2) rotate(-10deg); }
    75% { transform: scale(1.2) rotate(10deg); }
  }
  
  @media print {
    .btn, .alert, .navbar, footer, hr { display: none !important; }
    .fade-in-scale { animation: none; }
    .card { box-shadow: none !important; border: 1px solid #ddd !important; page-break-inside: avoid; }
    body { background: white !important; }
    body::before { display: none !important; }
  }
</style>

<script>
  const minatData = {{ minat | tojson }};

  const ctx = document.getElementById('minatChart').getContext('2d');
  const myChart = new Chart(ctx, {
      type: 'radar',
      data: {
          labels: ['ğŸ§  Logika/Analisis', 'ğŸ¤ Sosial/Komunikasi', 'ğŸ¨ Kreatif/Desain', 'ğŸ“š Bahasa/Literasi'],
          datasets: [{
              label: 'Skor Minat Kamu',
              data: [
                  minatData.logika, 
                  minatData.sosial, 
                  minatData.kreatif, 
                  minatData.bahasa
              ],
              fill: true,
              backgroundColor: 'rgba(102, 126, 234, 0.15)',
              borderColor: 'rgb(102, 126, 234)',
              borderWidth: 3,
              pointBackgroundColor: 'rgb(102, 126, 234)',
              pointBorderColor: '#fff',
              pointBorderWidth: 3,
              pointRadius: 6,
              pointHoverBackgroundColor: '#fff',
              pointHoverBorderColor: 'rgb(102, 126, 234)',
              pointHoverRadius: 8
          }]
      },
      options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
              r: { 
                  angleLines: { 
                      display: true,
                      color: 'rgba(0, 0, 0, 0.1)'
                  },
                  grid: {
                      color: 'rgba(0, 0, 0, 0.1)'
                  },
                  suggestedMin: 0,
                  suggestedMax: 5,
                  pointLabels: {
                      font: { 
                          size: 13, 
                          weight: '700',
                          family: 'Inter'
                      },
                      color: '#4a5568'
                  },
                  ticks: {
                      stepSize: 1,
                      backdropColor: 'rgba(255, 255, 255, 0.9)',
                      color: '#4a5568',
                      font: {
                          weight: '600'
                      }
                  }
              }
          },
          plugins: {
              legend: { 
                  display: true,
                  labels: {
                      font: {
                          size: 14,
                          weight: '700',
                          family: 'Inter'
                      },
                      color: '#4a5568',
                      padding: 20
                  }
              },
              tooltip: {
                  backgroundColor: 'rgba(0, 0, 0, 0.8)',
                  padding: 12,
                  titleFont: {
                      size: 14,
                      weight: '700'
                  },
                  bodyFont: {
                      size: 13
                  },
                  cornerRadius: 8
              }
          }
      }
  });
</script>

{% endblock %}